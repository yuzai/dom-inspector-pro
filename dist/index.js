!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).DomInspector={})}(this,function(t){"use strict";var e,i,n,o;function r(t,e){const i=t;Object.keys(e).forEach(t=>{!{}.hasOwnProperty.call(e,t)||(i[t]=e[t])}),i}e=".dom-inspector {\n    position: fixed;\n    pointer-events: none;\n    transform-origin: 0 0;\n}\n\n.dom-inspector > div {\n    position: absolute;\n    pointer-events: none;\n}\n\n.dom-inspector-wrapper .tips {\n    max-width: 70%;\n    background-color: #333740;\n    font-size: 0;\n    line-height: 18px;\n    padding: 3px 10px;\n    position: fixed;\n    border-radius: 4px;\n    display: none;\n    pointer-events: none;\n}\n\n.dom-inspector-wrapper .tips.reverse {\n}\n\n.dom-inspector-wrapper .tips .triangle {\n    width: 0;\n    height: 0;\n    position: absolute;\n    border-top: 8px solid #333740;\n    border-right: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n    border-left: 8px solid transparent;\n    left: 10px;\n    bottom: -16px;\n}\n\n.dom-inspector-wrapper .tips.reverse .triangle {\n    border-top: 8px solid transparent;\n    border-right: 8px solid transparent;\n    border-bottom: 8px solid #333740;\n    border-left: 8px solid transparent;\n    left: 10px;\n    top: -16px;\n}\n\n.dom-inspector-wrapper .tips.reverse-r .triangle {\n    left: auto;\n    right: 10px;\n}\n\n.dom-inspector-wrapper .tips > div {\n    display: inline-block;\n    vertical-align: middle;\n    font-size: 12px;\n    font-family: Consolas, Menlo, Monaco, Courier, monospace;\n    overflow: auto;\n}\n\n.dom-inspector-wrapper .tips .tag {\n    color: #e776e0;\n}\n\n.dom-inspector-wrapper .tips .id {\n    color: #eba062;\n}\n\n.dom-inspector-wrapper .tips .class {\n    color: #8dd2fb;\n}\n\n.dom-inspector-wrapper .tips .line {\n    color: #fff;\n}\n\n.dom-inspector-wrapper .tips .size {\n    color: #fff;\n}\n\n.dom-inspector-theme-default .margin {\n    background-color: rgb(246, 193, 139, 0.75);\n}\n\n.dom-inspector-theme-default .border {\n    background-color: rgba(250, 215, 138, 0.75);\n}\n\n.dom-inspector-theme-default .padding {\n    background-color: rgba(182, 200, 120, 0.75);\n}\n\n.dom-inspector-theme-default .content {\n    background-color: rgba(81, 101, 255, 0.75);\n}\n",i=(i=void 0===i?{}:i).insertAt,e&&"undefined"!=typeof document&&(n=document.head||document.getElementsByTagName("head")[0],(o=document.createElement("style")).type="text/css","top"===i&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)));const p=["svg","path","g","image","text","line","rect","polygon","circle","ellipse"],l=["html","body",...p],h=t=>{t=t.tagName.toLowerCase();return-1!==p.indexOf(t)?`*[name()='${t}']`:t};function f(e){let i=e,n=(e instanceof Object&&(i=Object.keys(e).map(t=>e[t])),0);for(let t=0;t<i.length;t++)i[t]>n&&(n=i[t]);return n}function b({num:t,total:e,min:i=5,ratio:n=.7}){return!(t<i)&&Number((t/e).toFixed(1))>=n}const d=document.createElement("style");function a(t=!1){d.innerHTML=t?"":`
        * {
            touch-action: none;
        }`}function g(t){return t&&"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}function w(t,e){return(void 0!==e&&g(e)?e:document).querySelector(t)}function y(e,i){Object.keys(i).forEach(t=>{e.style.setProperty(t,i[t])})}function c(t,e){let i=0;for(;t;)t.nodeName.toLowerCase()===e&&(i+=1),t=t.previousElementSibling;return i}function E(t){var e=t.getBoundingClientRect();return{scalex:Number((void 0===t.offsetWidth?1:t.offsetWidth/e.width).toFixed(1)),scaley:Number((void 0===t.offsetHeight?1:t.offsetHeight/e.height).toFixed(1))}}function L(t){const e={};const i=getComputedStyle(t);["border-top-width","border-right-width","border-bottom-width","border-left-width","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","z-index"].forEach(t=>{e[t]=parseFloat(i.getPropertyValue(t))||0});var n=t.getBoundingClientRect(),o=void 0===t.offsetWidth?n.width:t.offsetWidth-e["border-left-width"]-e["border-right-width"]-e["padding-left"]-e["padding-right"],n=void 0===t.offsetHeight?n.height:t.offsetHeight-e["border-top-width"]-e["border-bottom-width"]-e["padding-top"]-e["padding-bottom"];return r(e,{width:o,height:n}),r(e,function(t){var e=window.getComputedStyle(t),i=t.getBoundingClientRect(),{scalex:t,scaley:n}=E(t),o=i.left*t-parseFloat(e.getPropertyValue("margin-left"));return{top:i.top*n-parseFloat(e.getPropertyValue("margin-top")),left:o,right:i.right*t+parseFloat(e.getPropertyValue("margin-right")),scalex:t,scaley:n}}(t)),e}function s(){return[...document.querySelectorAll("*")].reduce((t,e)=>Math.max(t,+window.getComputedStyle(e).zIndex||0),0)}function M(t,e,i){const n=window.document.createElement(t);return Object.keys(e).forEach(t=>{n.setAttribute(t,e[t])}),i&&(n.innerHTML=i),n}function T(t,e,i){e=M("div",{class:e},i);return t.appendChild(e),e}function m({target:t,root:e,id:i="dom-inspector",assistEle:n,theme:o="dom-inspector-theme-default",maxZIndex:r=9999}){if(!t)return null;var d=M("div",{style:"z-index: "+r,class:"dom-inspector-wrapper"});const a=M("div",{id:i,class:"dom-inspector "+o,style:"z-index: "+r});d.appendChild(a);var i={parent:a,content:T(a,"content"),paddingTop:T(a,"padding padding-top"),paddingRight:T(a,"padding padding-right"),paddingBottom:T(a,"padding padding-bottom"),paddingLeft:T(a,"padding padding-left"),borderTop:T(a,"border border-top"),borderRight:T(a,"border border-right"),borderBottom:T(a,"border border-bottom"),borderLeft:T(a,"border border-left"),marginTop:T(a,"margin margin-top"),marginRight:T(a,"margin margin-right"),marginBottom:T(a,"margin margin-bottom"),marginLeft:T(a,"margin margin-left"),tips:T(d,"tips",'<div class="tag"></div><div class="id"></div><div class="class"></div><div class="line">&nbsp;|&nbsp;</div><div class="size"></div><div class="triangle"></div>')},{scalex:o,scaley:n}=E(n),{scalex:s,scaley:p}=E(t),l=L(t);const h=l.width,g=l.height,c=l["padding-left"]+h+l["padding-right"],m=l["padding-top"]+g+l["padding-bottom"],u=l["border-left-width"]+c+l["border-right-width"],f=l["border-top-width"]+m+l["border-bottom-width"],b=l["margin-left"]+u+l["margin-right"],v=l["margin-top"]+f+l["margin-bottom"];y(i.parent,{width:b+"px",height:v+"px",top:l.top/p*n+"px",left:l.left/s*o+"px"}),s===o&&p===n||y(i.parent,{transform:`scale(${o/s}, ${n/p})`}),y(i.content,{width:h+"px",height:g+"px",top:l["margin-top"]+l["border-top-width"]+l["padding-top"]+"px",left:l["margin-left"]+l["border-left-width"]+l["padding-left"]+"px"}),y(i.paddingTop,{width:c+"px",height:l["padding-top"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+l["border-left-width"]+"px"}),y(i.paddingRight,{width:l["padding-right"]+"px",height:m-l["padding-top"]+"px",top:l["padding-top"]+l["margin-top"]+l["border-top-width"]+"px",right:l["margin-right"]+l["border-right-width"]+"px"}),y(i.paddingBottom,{width:c-l["padding-right"]+"px",height:l["padding-bottom"]+"px",bottom:l["margin-bottom"]+l["border-bottom-width"]+"px",right:l["padding-right"]+l["margin-right"]+l["border-right-width"]+"px"}),y(i.paddingLeft,{width:l["padding-left"]+"px",height:m-l["padding-top"]-l["padding-bottom"]+"px",top:l["padding-top"]+l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+l["border-left-width"]+"px"}),y(i.borderTop,{width:u+"px",height:l["border-top-width"]+"px",top:l["margin-top"]+"px",left:l["margin-left"]+"px"}),y(i.borderRight,{width:l["border-right-width"]+"px",height:f-l["border-top-width"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",right:l["margin-right"]+"px"}),y(i.borderBottom,{width:u-l["border-right-width"]+"px",height:l["border-bottom-width"]+"px",bottom:l["margin-bottom"]+"px",right:l["margin-right"]+l["border-right-width"]+"px"}),y(i.borderLeft,{width:l["border-left-width"]+"px",height:f-l["border-top-width"]-l["border-bottom-width"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+"px"}),y(i.marginTop,{width:b+"px",height:l["margin-top"]+"px",top:0,left:0}),y(i.marginRight,{width:l["margin-right"]+"px",height:v-l["margin-top"]+"px",top:l["margin-top"]+"px",right:0}),y(i.marginBottom,{width:b-l["margin-right"]+"px",height:l["margin-bottom"]+"px",bottom:0,right:l["margin-right"]+"px"}),y(i.marginLeft,{width:l["margin-left"]+"px",height:v-l["margin-top"]-l["margin-bottom"]+"px",top:l["margin-top"]+"px",left:0}),w(".tag",i.tips).innerHTML=t.tagName.toLowerCase(),w(".id",i.tips).innerHTML=t.id?"#"+t.id:"",w(".size",i.tips).innerHTML=b/s+"x"+v/p;let x=0;t=["top","left"],x=32<=l.top/p?(i.tips.classList.remove("reverse"),(l.top/p-24-8)*n):(i.tips.classList.add("reverse"),((v+l.top)/p+8)*n),t[0]="top",p={left:"auto",right:"auto"};return l.left/s*o>.7*document.body.clientWidth?(i.tips.classList.add("reverse-r"),t[1]="right",p.right=document.body.clientWidth-l.right/s*o+"px"):(i.tips.classList.remove("reverse-r"),p.left=l.left/s*o+"px",t[1]="left"),y(i.tips,Object.assign(Object.assign({top:x+"px"},p),{display:"block","z-index":r})),1===Number(o)&&1===Number(n)||y(i.tips,{transform:`scale(${o}, ${n})`,"transform-origin":t[0]+" "+t[1]}),e.appendChild(d),()=>{a.parentNode.removeChild(a)}}function u(i){if(i){let t=i,e=0;for(;t&&t.nodeType===Node.ELEMENT_NODE&&t!==document.body;){var n=t.parentNode.children,o={},r={};for(let t=0;t<n.length;t++){var d=n[t],a=(o[d.tagName]?o[d.tagName]+=1:o[d.tagName]=1,d.classList),s=4<a.length?4:a.length;for(let t=0;t<s;t++){var p=a[t];r[p]?r[p]+=1:r[p]=1}}var l=f(o),h=f(r);if(b({num:l,total:n.length}))if(b({num:h,total:n.length})){var g={};for(let t=0;t<n.length;t++){var c=n[t].children,m=[];for(let t=0;t<c.length;t++)m.push(c[t].tagName);var u=m.join("~");g[u]?g[u]+=1:g[u]=1}if(b({num:f(g),total:n.length,min:2}))return{listEl:t,ele:i,preLevel:e}}t=t.parentNode,e+=1}}return!1}function v(t){var e;return t instanceof TouchEvent&&t.touches?(e=t.changedTouches[0],document.elementFromPoint(e.clientX,e.clientY)):t.target}function x(t,i=!1){if(!g(t))return null;let n=t,o=!1;for(var r=-1!==p.indexOf(n.tagName.toLowerCase()),d=[];n&&n.nodeType===Node.ELEMENT_NODE;){var a=n.nodeName.toLowerCase(),s=c(n,a);let t="",e=(!o&&n.hasAttribute("id")&&(t=`[@id="${n.id}"]`,o=!0),"");if(e=t||-1!==l.indexOf(a)&&1===s?"":`[${s}]`,d.push(""+h(n)+e+t),t&&!r&&!i){d.push("");break}n=n.parentNode}return"/"+d.reverse().join("/")}function N(t,e=0){if(!g(t))return null;let i=x(t,!0);return i?((i=i.split("/").slice(1).reverse())[e]=i[e].split("[")[0]+"[*]","/"+i.reverse().join("/")):null}function C(t,e=200){var i=document,n=i.evaluate(t,i);let o=n;var r=[];let d=0;for(;o&&d<e;)(o=n.iterateNext())&&r.push(o),d++;return r}document.head.appendChild(d);const _=/Mobi|Android|iPhone/i.test(navigator.userAgent),O=document.querySelector("body"),S=document.querySelector("html");t.$=w,t.addOverlay=m,t.addRule=y,t.createElement=M,t.createSurroundEle=T,t.default=class{constructor(t){this.theme="dom-inspector-theme-default",this.maxZIndex=s()+1,this.mode="single",this.env=_?"mobile":"pc",this.xpath=null,this.target="",this.status="disable",this.onMoveSelect=()=>{},this.onDidSelect=()=>{},this.assistEle=M("div",{style:`pointer-events: none;
        visibility: hidden;
        width: 100px;
        height: 100px;
        position: absolute;
        top: -100px;`}),this._cachedTarget="",this.event="mousemove",this.overlay=M("div",{id:"dom-inspector-root",style:`z-index: ${this.maxZIndex};`}),void 0!==t.theme&&(this.theme=t.theme),void 0!==t.maxZIndex&&(this.maxZIndex=t.maxZIndex),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.env&&(this.env=t.env),this.event="pc"===this.env?"mousemove":"touchmove",void 0!==t.onMoveSelect&&(this.onMoveSelect=t.onMoveSelect),void 0!==t.onDidSelect&&(this.onDidSelect=t.onDidSelect),this._throttleOnMove=function(n,o){let r,d,a=Date.now();return function(...t){const e=this;function i(){a=Date.now(),r=null,n.apply(e,t)}"number"==typeof r&&window.clearTimeout(r),(d=Date.now()-a)>o?i():r=window.setTimeout(i,o-d)}}(this._onMove.bind(this),100),this._onMoveEnd=this._onMoveEnd.bind(this),S&&S.appendChild(this.overlay),S&&S.appendChild(this.assistEle),this._addBodyClick()}_addBodyClick(){document.body.addEventListener("click",t=>{"enable"===this.status&&(t.preventDefault(),t.stopPropagation(),this.onDidSelect(this.target))},!0)}enable(t="single"){return this.status="enable",this.xpath=null,this.target="",this.mode=t,this.overlay.style.display="block",O&&O.addEventListener(this.event,this._throttleOnMove,{capture:!0,passive:"mobile"!==this.env}),"mobile"===this.env&&(O&&O.addEventListener("touchend",this._onMoveEnd,{capture:!0,passive:!1}),a(!1)),null}pause(){this.status="pause",O&&O.removeEventListener(this.event,this._throttleOnMove,!0),"mobile"===this.env&&(O&&O.removeEventListener("touchend",this._onMoveEnd,{capture:!0}),a(!0))}disable(){this.status="disable",this.xpath=null,this.target="",this.overlay.style.display="none",this.overlay.style.width="0",this.overlay.style.height="0",O&&O.removeEventListener(this.event,this._throttleOnMove,!0),"mobile"===this.env&&(O&&O.removeEventListener("touchend",this._onMoveEnd,{capture:!0}),a(!0))}selectTarget(t){t&&(this._remove(),m({target:t,root:this.overlay,assistEle:this.assistEle}))}selectTargets(e){if(e&&e.length){this._remove();var i=e.length;for(let t=0;t<i;t++)m({target:e[t],root:this.overlay,assistEle:this.assistEle})}}_remove(){this.overlay.innerHTML=""}_onMove(t){t=v(t);if(!t||!this.overlay.contains(t)){if((this.target=t)===this._cachedTarget)return null;if(this._remove(),this._cachedTarget=t,this.onMoveSelect(t),"multi"===this.mode){var i=u(t);if(i){var n=N(i.ele,i.preLevel);let e=C(this.xpath=n);9<e.length&&(n=e.indexOf(i.ele),e=n<5?e.slice(0,9):n>e.length-5?e.slice(-9):e.slice(n-4,n+5));for(let t=0;t<e.length;t++)m({target:e[t],root:this.overlay,assistEle:this.assistEle});return}}this.xpath=null,m({target:t,root:this.overlay,assistEle:this.assistEle})}}_onMoveEnd(t){t.preventDefault(),this._onMove(t);const e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),i=document.body;setTimeout(()=>{i.dispatchEvent(e)},500)}},t.detectList=u,t.findIndex=c,t.getEleByXpath=function(t){var e=document;return e.evaluate(t,e).iterateNext()},t.getElementInfo=L,t.getElesByXpath=C,t.getMaxZIndex=s,t.getNearestNoSvgXpath=function(t){if(-1===t.indexOf("*[name()="))return t;var e=t.split("/"),i=[];for(let t=0;t<e.length-1;t++){var n=e[t];if(-1!==n.indexOf("*[name()="))break;i.push(n)}return i.join("/")},t.getTouchMouseTargetElement=v,t.getXpath=x,t.getXpathList=N,t.isDOM=g,Object.defineProperty(t,"__esModule",{value:!0})});
