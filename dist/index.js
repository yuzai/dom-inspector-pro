!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).DomInspector=e()}(this,function(){"use strict";var t,e,i,o;function r(t,e){const i=t;Object.keys(e).forEach(t=>{!{}.hasOwnProperty.call(e,t)||(i[t]=e[t])}),i}t=".dom-inspector {\n    position: fixed;\n    pointer-events: none;\n    transform-origin: 0 0;\n}\n\n.dom-inspector > div {\n    position: absolute;\n    pointer-events: none;\n}\n\n.dom-inspector-wrapper .tips {\n    max-width: 70%;\n    background-color: #333740;\n    font-size: 0;\n    line-height: 18px;\n    padding: 3px 10px;\n    position: fixed;\n    border-radius: 4px;\n    display: none;\n    pointer-events: none;\n}\n\n.dom-inspector-wrapper .tips.reverse {\n}\n\n.dom-inspector-wrapper .tips .triangle {\n    width: 0;\n    height: 0;\n    position: absolute;\n    border-top: 8px solid #333740;\n    border-right: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n    border-left: 8px solid transparent;\n    left: 10px;\n    bottom: -16px;\n}\n\n.dom-inspector-wrapper .tips.reverse .triangle {\n    border-top: 8px solid transparent;\n    border-right: 8px solid transparent;\n    border-bottom: 8px solid #333740;\n    border-left: 8px solid transparent;\n    left: 10px;\n    top: -16px;\n}\n\n.dom-inspector-wrapper .tips.reverse-r .triangle {\n    left: auto;\n    right: 10px;\n}\n\n.dom-inspector-wrapper .tips > div {\n    display: inline-block;\n    vertical-align: middle;\n    font-size: 12px;\n    font-family: Consolas, Menlo, Monaco, Courier, monospace;\n    overflow: auto;\n}\n\n.dom-inspector-wrapper .tips .tag {\n    color: #e776e0;\n}\n\n.dom-inspector-wrapper .tips .id {\n    color: #eba062;\n}\n\n.dom-inspector-wrapper .tips .class {\n    color: #8dd2fb;\n}\n\n.dom-inspector-wrapper .tips .line {\n    color: #fff;\n}\n\n.dom-inspector-wrapper .tips .size {\n    color: #fff;\n}\n\n.dom-inspector-theme-default .margin {\n    background-color: rgb(246, 193, 139, 0.75);\n}\n\n.dom-inspector-theme-default .border {\n    background-color: rgba(250, 215, 138, 0.75);\n}\n\n.dom-inspector-theme-default .padding {\n    background-color: rgba(182, 200, 120, 0.75);\n}\n\n.dom-inspector-theme-default .content {\n    background-color: rgba(81, 101, 255, 0.75);\n}\n",e=(e=void 0===e?{}:e).insertAt,t&&"undefined"!=typeof document&&(i=document.head||document.getElementsByTagName("head")[0],(o=document.createElement("style")).type="text/css","top"===e&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)));const p=["svg","path","g","image","text","line","rect","polygon","circle","ellipse"],l=["html","body",...p],h=t=>{t=t.tagName.toLowerCase();return-1!==p.indexOf(t)?`*[name()='${t}']`:t};function u(e){let i=e,o=(e instanceof Object&&(i=Object.keys(e).map(t=>e[t])),0);for(let t=0;t<i.length;t++)i[t]>o&&(o=i[t]);return o}function b({num:t,total:e,min:i=5,ratio:o=.7}){return!(t<i)&&Number((t/e).toFixed(1))>=o}const n=document.createElement("style");function d(t=!1){n.innerHTML=t?"":`
        * {
            touch-action: none;
        }`}function g(t){return t&&"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}function w(t,e){return(void 0!==e&&g(e)?e:document).querySelector(t)}function y(e,i){Object.keys(i).forEach(t=>{e.style.setProperty(t,i[t])})}function E(t){var e=t.getBoundingClientRect();return{scalex:Number((void 0===t.offsetWidth?1:t.offsetWidth/e.width).toFixed(1)),scaley:Number((void 0===t.offsetHeight?1:t.offsetHeight/e.height).toFixed(1))}}function L(t){const e={};const i=getComputedStyle(t);["border-top-width","border-right-width","border-bottom-width","border-left-width","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","z-index"].forEach(t=>{e[t]=parseFloat(i.getPropertyValue(t))||0});var o=t.getBoundingClientRect(),n=void 0===t.offsetWidth?o.width:t.offsetWidth-e["border-left-width"]-e["border-right-width"]-e["padding-left"]-e["padding-right"],o=void 0===t.offsetHeight?o.height:t.offsetHeight-e["border-top-width"]-e["border-bottom-width"]-e["padding-top"]-e["padding-bottom"];return r(e,{width:n,height:o}),r(e,function(t){var e=window.getComputedStyle(t),i=t.getBoundingClientRect(),{scalex:t,scaley:o}=E(t),n=i.left*t-parseFloat(e.getPropertyValue("margin-left"));return{top:i.top*o-parseFloat(e.getPropertyValue("margin-top")),left:n,right:i.right*t+parseFloat(e.getPropertyValue("margin-right")),scalex:t,scaley:o}}(t)),e}function T(t,e,i){const o=window.document.createElement(t);return Object.keys(e).forEach(t=>{o.setAttribute(t,e[t])}),i&&(o.innerHTML=i),o}function M(t,e,i){e=T("div",{class:e},i);return t.appendChild(e),e}function a({target:e,root:i,id:o="dom-inspector",assistEle:n,theme:r="dom-inspector-theme-default",maxZIndex:d=9999}){if(e){var a=T("div",{style:"z-index: "+d,class:"dom-inspector-wrapper"});const h=T("div",{id:o,class:"dom-inspector "+r,style:"z-index: "+d});a.appendChild(h);var o={parent:h,content:M(h,"content"),paddingTop:M(h,"padding padding-top"),paddingRight:M(h,"padding padding-right"),paddingBottom:M(h,"padding padding-bottom"),paddingLeft:M(h,"padding padding-left"),borderTop:M(h,"border border-top"),borderRight:M(h,"border border-right"),borderBottom:M(h,"border border-bottom"),borderLeft:M(h,"border border-left"),marginTop:M(h,"margin margin-top"),marginRight:M(h,"margin margin-right"),marginBottom:M(h,"margin margin-bottom"),marginLeft:M(h,"margin margin-left"),tips:M(a,"tips",'<div class="tag"></div><div class="id"></div><div class="class"></div><div class="line">&nbsp;|&nbsp;</div><div class="size"></div><div class="triangle"></div>')},{scalex:r,scaley:n}=E(n),{scalex:s,scaley:p}=E(e),l=L(e);const g=l.width,m=l.height,c=l["padding-left"]+g+l["padding-right"],f=l["padding-top"]+m+l["padding-bottom"],u=l["border-left-width"]+c+l["border-right-width"],b=l["border-top-width"]+f+l["border-bottom-width"],v=l["margin-left"]+u+l["margin-right"],x=l["margin-top"]+b+l["margin-bottom"];y(o.parent,{width:v+"px",height:x+"px",top:l.top/p*n+"px",left:l.left/s*r+"px"}),s===r&&p===n||y(o.parent,{transform:`scale(${r/s}, ${n/p})`}),y(o.content,{width:g+"px",height:m+"px",top:l["margin-top"]+l["border-top-width"]+l["padding-top"]+"px",left:l["margin-left"]+l["border-left-width"]+l["padding-left"]+"px"}),y(o.paddingTop,{width:c+"px",height:l["padding-top"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+l["border-left-width"]+"px"}),y(o.paddingRight,{width:l["padding-right"]+"px",height:f-l["padding-top"]+"px",top:l["padding-top"]+l["margin-top"]+l["border-top-width"]+"px",right:l["margin-right"]+l["border-right-width"]+"px"}),y(o.paddingBottom,{width:c-l["padding-right"]+"px",height:l["padding-bottom"]+"px",bottom:l["margin-bottom"]+l["border-bottom-width"]+"px",right:l["padding-right"]+l["margin-right"]+l["border-right-width"]+"px"}),y(o.paddingLeft,{width:l["padding-left"]+"px",height:f-l["padding-top"]-l["padding-bottom"]+"px",top:l["padding-top"]+l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+l["border-left-width"]+"px"}),y(o.borderTop,{width:u+"px",height:l["border-top-width"]+"px",top:l["margin-top"]+"px",left:l["margin-left"]+"px"}),y(o.borderRight,{width:l["border-right-width"]+"px",height:b-l["border-top-width"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",right:l["margin-right"]+"px"}),y(o.borderBottom,{width:u-l["border-right-width"]+"px",height:l["border-bottom-width"]+"px",bottom:l["margin-bottom"]+"px",right:l["margin-right"]+l["border-right-width"]+"px"}),y(o.borderLeft,{width:l["border-left-width"]+"px",height:b-l["border-top-width"]-l["border-bottom-width"]+"px",top:l["margin-top"]+l["border-top-width"]+"px",left:l["margin-left"]+"px"}),y(o.marginTop,{width:v+"px",height:l["margin-top"]+"px",top:0,left:0}),y(o.marginRight,{width:l["margin-right"]+"px",height:x-l["margin-top"]+"px",top:l["margin-top"]+"px",right:0}),y(o.marginBottom,{width:v-l["margin-right"]+"px",height:l["margin-bottom"]+"px",bottom:0,right:l["margin-right"]+"px"}),y(o.marginLeft,{width:l["margin-left"]+"px",height:x-l["margin-top"]-l["margin-bottom"]+"px",top:l["margin-top"]+"px",left:0}),w(".tag",o.tips).innerHTML=e.tagName.toLowerCase(),w(".id",o.tips).innerHTML=e.id?"#"+e.id:"",w(".size",o.tips).innerHTML=v/s+"x"+x/p;let t=0;e=["top","left"],p=(t=32<=l.top/p?(o.tips.classList.remove("reverse"),(l.top/p-24-8)*n):(o.tips.classList.add("reverse"),((x+l.top)/p+8)*n),e[0]="top",{left:"auto",right:"auto"});l.left/s*r>.7*document.body.clientWidth?(o.tips.classList.add("reverse-r"),e[1]="right",p.right=document.body.clientWidth-l.right/s*r+"px"):(o.tips.classList.remove("reverse-r"),p.left=l.left/s*r+"px",e[1]="left"),y(o.tips,Object.assign(Object.assign({top:t+"px"},p),{display:"block","z-index":d})),1===Number(r)&&1===Number(n)||y(o.tips,{transform:`scale(${r}, ${n})`,"transform-origin":e[0]+" "+e[1]}),i.appendChild(a)}}function s(t,i=!1){if(!g(t))return null;let o=t,n=!1;for(var r=-1!==p.indexOf(o.tagName.toLowerCase()),d=[];o&&o.nodeType===Node.ELEMENT_NODE;){var a=o.nodeName.toLowerCase(),s=function(t,e){let i=0;for(;t;)t.nodeName.toLowerCase()===e&&(i+=1),t=t.previousElementSibling;return i}(o,a);let t="",e=(!n&&o.hasAttribute("id")&&(t=`[@id="${o.id}"]`,n=!0),"");if(e=t||-1!==l.indexOf(a)&&1===s?"":`[${s}]`,d.push(""+h(o)+e+t),t&&!r&&!i){d.push("");break}o=o.parentNode}return"/"+d.reverse().join("/")}document.head.appendChild(n);const m=/Mobi|Android|iPhone/i.test(navigator.userAgent),c=document.querySelector("body"),f=document.querySelector("html");return class{constructor(t){this.theme="dom-inspector-theme-default",this.maxZIndex=[...document.querySelectorAll("*")].reduce((t,e)=>Math.max(t,+window.getComputedStyle(e).zIndex||0),0)+1,this.mode="single",this.env=m?"mobile":"pc",this.xpath=null,this.target="",this.status="disable",this.onMoveSelect=()=>{},this.onDidSelect=()=>{},this.assistEle=T("div",{style:`pointer-events: none;
        visibility: hidden;
        width: 100px;
        height: 100px;
        position: absolute;
        top: -100px;`}),this._cachedTarget="",this.event="mousemove",this.overlay=T("div",{id:"dom-inspector-root",style:`z-index: ${this.maxZIndex};`}),void 0!==t.theme&&(this.theme=t.theme),void 0!==t.maxZIndex&&(this.maxZIndex=t.maxZIndex),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.env&&(this.env=t.env),this.event="pc"===this.env?"mousemove":"touchmove",void 0!==t.onMoveSelect&&(this.onMoveSelect=t.onMoveSelect),void 0!==t.onDidSelect&&(this.onDidSelect=t.onDidSelect),this._throttleOnMove=function(o,n){let r,d,a=Date.now();return function(...t){const e=this;function i(){a=Date.now(),r=null,o.apply(e,t)}"number"==typeof r&&window.clearTimeout(r),(d=Date.now()-a)>n?i():r=window.setTimeout(i,n-d)}}(this._onMove.bind(this),100),this._onMoveEnd=this._onMoveEnd.bind(this),f&&f.appendChild(this.overlay),f&&f.appendChild(this.assistEle),this._addBodyClick()}_addBodyClick(){document.body.addEventListener("click",t=>{"enable"===this.status&&(t.preventDefault(),t.stopPropagation(),this.onDidSelect(this.target))},!0)}enable(t="single"){return this.status="enable",this.xpath=null,this.target="",this.mode=t,this.overlay.style.display="block",c&&c.addEventListener(this.event,this._throttleOnMove,{capture:!0,passive:"mobile"!==this.env}),"mobile"===this.env&&(c&&c.addEventListener("touchend",this._onMoveEnd,{capture:!0,passive:!1}),d(!1)),null}pause(){this.status="pause",c&&c.removeEventListener(this.event,this._throttleOnMove,!0),"mobile"===this.env&&(c&&c.removeEventListener("touchend",this._onMoveEnd,{capture:!0}),d(!0))}disable(){this.status="disable",this.xpath=null,this.target="",this.overlay.style.display="none",this.overlay.style.width="0",this.overlay.style.height="0",c&&c.removeEventListener(this.event,this._throttleOnMove,!0),"mobile"===this.env&&(c&&c.removeEventListener("touchend",this._onMoveEnd,{capture:!0}),d(!0))}selectTarget(t){t&&(this._remove(),a({target:t,root:this.overlay,assistEle:this.assistEle}))}selectTargets(e){if(e&&e.length){this._remove();var i=e.length;for(let t=0;t<i;t++)a({target:e[t],root:this.overlay,assistEle:this.assistEle})}}_remove(){this.overlay.innerHTML=""}_onMove(t){var e=(t=t)instanceof TouchEvent&&t.touches?(e=t.changedTouches[0],document.elementFromPoint(e.clientX,e.clientY)):t.target;if(!e||!this.overlay.contains(e)){if((this.target=e)===this._cachedTarget)return null;if(this._remove(),this._cachedTarget=e,this.onMoveSelect(e),"multi"===this.mode){t=function(i){if(i){let t=i,e=0;for(;t&&t.nodeType===Node.ELEMENT_NODE&&t!==document.body;){var o=t.parentNode.children,n={},r={};for(let t=0;t<o.length;t++){var d=o[t],a=(n[d.tagName]?n[d.tagName]+=1:n[d.tagName]=1,d.classList),s=4<a.length?4:a.length;for(let t=0;t<s;t++){var p=a[t];r[p]?r[p]+=1:r[p]=1}}var l=u(n),h=u(r);if(b({num:l,total:o.length}))if(b({num:h,total:o.length})){var g={};for(let t=0;t<o.length;t++){var m=o[t].children,c=[];for(let t=0;t<m.length;t++)c.push(m[t].tagName);var f=c.join("~");g[f]?g[f]+=1:g[f]=1}if(b({num:u(g),total:o.length,min:2}))return{listEl:t,ele:i,preLevel:e}}t=t.parentNode,e+=1}}return!1}(e);if(t){var i=function(t,e=0){if(!g(t))return null;let i=s(t,!0);return i?((i=i.split("/").slice(1).reverse())[e]=i[e].split("[")[0]+"[*]","/"+i.reverse().join("/")):null}(t.ele,t.preLevel);let e=function(t,e=200){var i=document,o=i.evaluate(t,i);let n=o;var r=[];let d=0;for(;n&&d<e;)(n=o.iterateNext())&&r.push(n),d++;return r}(this.xpath=i);9<e.length&&(i=e.indexOf(t.ele),e=i<5?e.slice(0,9):i>e.length-5?e.slice(-9):e.slice(i-4,i+5));for(let t=0;t<e.length;t++)a({target:e[t],root:this.overlay,assistEle:this.assistEle});return}}this.xpath=null,a({target:e,root:this.overlay,assistEle:this.assistEle})}}_onMoveEnd(t){t.preventDefault(),this._onMove(t);const e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),i=document.body;setTimeout(()=>{i.dispatchEvent(e)},500)}}});
